!function(t){var e={};function i(s){if(e[s])return e[s].exports;var o=e[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(s,o,function(e){return t[e]}.bind(null,o));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);var s=class{constructor(){this.visaType=$("#id_visa_type"),this.visaConditions=$("#visaConditions")}isValid(){return this.visaType.length>0}init(){this.isValid()&&this.visaType.change(t=>{2===this.visaType.val()||"2"===this.visaType.val()?this.visaConditions.removeClass("invisible"):this.visaConditions.addClass("invisible")})}};var o=class{constructor(){this.map=null,this.currentMarker=null,this.infoWindow=null,this.geocoder=null,this.latitude=0,this.longitude=0,this.address="",this.$form=null,this.$addressForm=null,this.$addressInput=null,this.$addressError=null,this.$locationError=null,this.$generalJobFields=null,this.googleMarkerMap={},this.googleMarkerMapHoverListeners={},this.googleMarkerMapClickListeners={},this.disinterestedIconImage=this.cdnImg("koco-man/gray-60x60.png"),this.appliedIconImage=this.cdnImg("koco-man/black-60x60.png")}init(){let t=document.getElementById("map");if(null!==t){let e="greedy";window.jobMap.isRecruiter&&(e="cooperative"),this.map=new google.maps.Map(t,{zoom:window.jobMap.zoom,center:{lat:window.jobMap.lat,lng:window.jobMap.lng},mapTypeControlOptions:{mapTypeIds:["roadmap"]},mapTypeControl:!1,streetViewControl:!1,gestureHandling:e}),this.addExistingJobMarkers(),this.infoWindow=new google.maps.InfoWindow,this.geocoder=new google.maps.Geocoder,this.$addressError=$("#addressSearchError"),this.$locationError=$("#postJobLocationError"),this.$addressInput=$("#mapAddressInput"),this.$warningModal=$("#warningModal"),window.jobMap.isRecruiter&&this.map.addListener("click",t=>{this.placeMarkerAndPanTo(t.latLng)}),this.$form=$("#jobPostForm"),this.$form.submit(t=>(this.$locationError.addClass("no-show"),this.latitude>0&&this.longitude>0?this.submitMapData(this.$form.attr("action")):this.$locationError.removeClass("no-show"),t.preventDefault(),!1)),this.$addressForm=$("#addressSearchForm"),this.$addressForm.submit(t=>(this.$addressError.addClass("no-show"),t.preventDefault(),this.geocodeAddressAndPlaceMarker($("#mapAddressInput").val()),!1)),this.$generalJobFields=$("#generalJobFields"),this.map.addListener("click",()=>{this.closeMapInfoWindow()}),this.$warningModal.length>0&&this.$warningModal.foundation("open")}}cdnImg(t){return"/static/images/"+t}addExistingJobMarkers(){for(let t=0;t<window.jobMap.markers.length;t++){let e=window.jobMap.markers[t],i=new google.maps.LatLng(e.lat,e.lng),s=this.resolveIconImage(e),o=new google.maps.Marker({position:i,optimized:!1,icon:this.makeComplexIcon(s)});o.setMap(this.map);let r=()=>{this.infoWindow.setContent(e.content),this.infoWindow.open(this.map,o)},n=o.addListener("mouseover",r),a=o.addListener("click",r);this.googleMarkerMap[e.id]=o,this.googleMarkerMapHoverListeners[e.id]=n,this.googleMarkerMapClickListeners[e.id]=a}}resolveIconImage(t){let e=window.jobMap.iconImage;return window.jobMap.isRecruiter?0===t.isJobPoster&&(e=this.disinterestedIconImage):1===t.hasApplied?e=this.appliedIconImage:1===t.isDisinterested&&(e=this.disinterestedIconImage),e}updateExistingJobMarker(t,e,i){let s=this.googleMarkerMap[t],o=1===i?this.disinterestedIconImage:window.jobMap.iconImage;s.setIcon(this.makeComplexIcon(o));let r=this.googleMarkerMapHoverListeners[t],n=this.googleMarkerMapClickListeners[t];google.maps.event.removeListener(r),google.maps.event.removeListener(n),delete this.googleMarkerMapHoverListeners[t],delete this.googleMarkerMapClickListeners[t],s.addListener("mouseover",()=>{this.infoWindow.setContent(e),this.infoWindow.open(this.map,s)}),s.addListener("click",()=>{this.infoWindow.setContent(e),this.infoWindow.open(this.map,s)}),this.infoWindow.close()}placeMarkerAndPanTo(t){null!==this.currentMarker&&this.currentMarker.setMap(null),this.currentMarker=new google.maps.Marker({position:t,map:this.map,icon:this.makeComplexIcon(window.jobMap.markerImage),animation:google.maps.Animation.DROP,draggable:!0}),google.maps.event.addListener(this.currentMarker,"dragend",t=>{this.retrackCurrentLocation(t.latLng)}),this.retrackCurrentLocation(t)}retrackCurrentLocation(t){this.latitude=t.lat(),this.longitude=t.lng(),this.geocodeLatLng(this.latitude,this.longitude,this.currentMarker)}makeComplexIcon(t){return{url:t,size:new google.maps.Size(30,30),scaledSize:new google.maps.Size(30,30)}}geocodeAddressAndPlaceMarker(t){this.geocoder.geocode({address:t},(t,e)=>{if("OK"===e){let e=t[0].geometry.location,i=t[0].formatted_address;this.map.setCenter(e),null!==this.currentMarker&&this.currentMarker.setMap(null),this.currentMarker=new google.maps.Marker({map:this.map,position:e,icon:this.makeComplexIcon(window.jobMap.markerImage),animation:google.maps.Animation.DROP}),this.latitude=e.lat(),this.longitude=e.lng(),this.address=i,this.infoWindow.setContent(i),this.infoWindow.open(this.map,this.currentMarker),$(window).scrollTop(0)}else this.$addressError.removeClass("no-show")})}geocodeLatLng(t,e,i){let s={lat:t,lng:e};this.geocoder.geocode({location:s},(t,e)=>{"OK"===e?t[0]?(this.address=t[0].formatted_address,this.$addressInput.val(t[0].formatted_address),this.infoWindow.setContent(this.address),this.infoWindow.open(this.map,i)):console.log("No results found"):console.log("Geocoder failed due to: "+e)})}submitMapData(t){let e={csrfmiddlewaretoken:$('input[name="csrfmiddlewaretoken"]').val(),title:$("#id_title").val(),class_type:$("#id_class_type").val(),contact_name:$("#id_contact_name").val(),contact_email:$("#id_contact_email").val(),contact_number:$("#id_contact_number").val(),schedule:$("#id_schedule").val(),other_requirements:$("#id_other_requirements").val(),is_full_time:$('input[name="is_full_time"]:checked').val(),salary:$("#id_salary").val(),benefits:$("#id_benefits").val(),pay_rate:$("#id_pay_rate").val(),latitude:this.latitude,longitude:this.longitude,address:this.address};$.ajax({type:"POST",url:t,data:e}).done(t=>{let e=$.parseHTML(t),i=$(e).find("#generalJobFields");t.includes("jobPostListConfirm")?window.location=window.jobMap.successLocation:this.$generalJobFields.html(i.html())})}closeMapInfoWindow(){this.infoWindow.close()}};class r{constructor(t,e,i){this.tagList=t.split(","),this.$dom=$(e),this.$parent=i,this.detachedCase=null,this.tooltips=[],this.bindRepostHoverEvent(),this.bindTooltipHideEvents(),this.isShowing=!1}hasTags(t){let e=!0;for(let i=0;i<t.length;i++){let s=t[i].trim(),o=!1;for(let t=0;t<this.tagList.length;t++)this.tagList[t].trim()===s&&(o=!0);if(!o){e=!1;break}}return e}detach(){this.detachedCase=this.$dom.parent().detach()}attach(){this.$parent.append(this.detachedCase)}bindRepostHoverEvent(){let t=this.$dom.find(".taken-down");t.length>0&&(t.on("mouseover",()=>{t.html("Repost")}),t.on("mouseleave",()=>{t.html("Taken down")}))}bindTooltipHideEvents(){if(this.tooltips=$(".flowcard-tooltip"),window.tooltipIsOpen=!1,this.tooltips.length>0){$("body").click(()=>{if(window.tooltipIsOpen){window.tooltipIsOpen=!1;for(let t=0;t<this.tooltips.length;t++){let e=this.tooltips[t];$(e).foundation("hide")}}});for(let t=0;t<this.tooltips.length;t++){let e=this.tooltips[t];$(e).on("show.zf.tooltip",function(){setTimeout(()=>{window.tooltipIsOpen=!0},1e3)})}}}}var n=class{constructor(){this.$filter1=$('input[name="job-filter-1"]'),this.$filter2=$('input[name="job-filter-2"]'),this.$cards=$(".flow-card"),this.$filterCardsParent=$("#filterCardsParent"),this.flowCardList=[],this.activeFilters=[],this.listFilterResults=null}isValid(){return this.$cards.length>0}init(){this.isValid()&&(this.listFilterResults=$("#listFilterResults"),this.setActiveFilters(),this.attachPrimaryFilterListener(),this.attachSecondaryFilterListener(),this.prepareFlowCards())}setActiveFilters(){let t=$('input[name="job-filter-1"]:checked').val();this.$filter2.length>0?this.activeFilters=[t,$('input[name="job-filter-2"]:checked').val()]:this.activeFilters=[t]}attachPrimaryFilterListener(){this.$filter1.click(t=>{let e=$(t.currentTarget).val();this.$filter2.length>0?this.activeFilters=[e,$('input[name="job-filter-2"]:checked').val()]:this.activeFilters=[e],this.applyFilter()})}attachSecondaryFilterListener(){this.$filter2.length>0&&this.$filter2.click(t=>{let e=$(t.currentTarget).val();this.activeFilters=[e,$('input[name="job-filter-1"]:checked').val()],this.applyFilter()})}applyFilter(){for(let t=0;t<this.flowCardList.length;t++){let e=this.flowCardList[t];e.hasTags(this.activeFilters)?e.attach():e.detach()}this.updateDisplayCount()}prepareFlowCards(){for(let t=0;t<this.$cards.length;t++){let e=this.$cards[t];this.flowCardList.push(new r($(e).data("filtertaglist"),e,this.$filterCardsParent))}}updateDisplayCount(){let t=this.flowCardList.length;if(this.$filterCardsParent.children().length===this.flowCardList.length)this.listFilterResults.html(`Currently displaying ${t}/${t}`);else{let e=this.$filterCardsParent.children().length;this.listFilterResults.html(`Currently displaying ${e}/${t}`)}}};$(document).foundation(),$(document).ready(function(){let t=new s,e=new n;t.init(),e.init()}),window.initMap=function(){let t=new o;t.init(),window.jobMapHandle=t},window.updateMapMarker=function(t,e,i,s){return t.preventDefault(),$.ajax({type:"GET",url:$(e).attr("href")}).done(t=>{window.jobMapHandle.updateExistingJobMarker(i,t,s)}),!1}}]);